# –ì–µ–Ω–µ—Ä–∞—Ü–∏—è QR-–∫–æ–¥–æ–≤

–í –ø—Ä–æ–µ–∫—Ç–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –≥–∏–±–∫–∞—è —Å–∏—Å—Ç–µ–º–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ QR-–∫–æ–¥–æ–≤, –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—â–∞—è –∫–∞–∫ –∫–ª–∏–µ–Ω—Ç—Å–∫—É—é, —Ç–∞–∫ –∏ —Å–µ—Ä–≤–µ—Ä–Ω—É—é –≥–µ–Ω–µ—Ä–∞—Ü–∏—é.

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –î–æ—Å—Ç—É–ø–Ω—ã–µ —Ä–µ–∂–∏–º—ã

1. **Client-side (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)** - –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –Ω–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–µ
2. **Server-side** - –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –Ω–∞ –±—ç–∫–µ–Ω–¥–µ
3. **Hybrid** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π fallback (—Å–µ—Ä–≤–µ—Ä ‚Üí –∫–ª–∏–µ–Ω—Ç)

### API Endpoints

```yaml
GET /objects/{id}/qrcode
- –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç QR-–∫–æ–¥ –¥–ª—è –æ–±—ä–µ–∫—Ç–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: image/png
- –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è: Bearer token
```

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

```bash
# –†–µ–∂–∏–º –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 'client')
VITE_QR_MODE=client|server

# –ü—Ä–∏–º–µ—Ä—ã:
VITE_QR_MODE=client  # –¢–æ–ª—å–∫–æ –∫–ª–∏–µ–Ω—Ç—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è
VITE_QR_MODE=server  # –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç —Å–µ—Ä–≤–µ—Ä–Ω–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
```

### –ü—Ä–æ–≥—Ä–∞–º–º–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

```typescript
import { generateQRCode } from '@shared/lib';

// –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –∫–ª–∏–µ–Ω—Ç—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è
const qrUrl = await generateQRCode(objectUrl, { mode: 'client' });

// –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ —Å–µ—Ä–≤–µ—Ä–Ω–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è
const qrUrl = await generateQRCode(objectId, { mode: 'server' });

// –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤—ã–±–æ—Ä (–ø–æ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –æ–∫—Ä—É–∂–µ–Ω–∏—è)
const qrUrl = await generateQRCode(textOrObjectId);
```

## –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø–æ–¥—Ö–æ–¥–æ–≤

| –ö—Ä–∏—Ç–µ—Ä–∏–π               | Client-side           | Server-side        |
| ---------------------- | --------------------- | ------------------ |
| **–°–∫–æ—Ä–æ—Å—Ç—å**           | ‚ö° –ú–≥–Ω–æ–≤–µ–Ω–Ω–æ          | üåê –ó–∞–≤–∏—Å–∏—Ç –æ—Ç —Å–µ—Ç–∏ |
| **–ù–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä** | ‚úÖ –ù–µ—Ç                | ‚ùå –ï—Å—Ç—å            |
| **–û—Ñ–ª–∞–π–Ω —Ä–∞–±–æ—Ç–∞**      | ‚úÖ –î–∞                 | ‚ùå –ù–µ—Ç             |
| **–ö–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å**    | ‚ö†Ô∏è –ó–∞–≤–∏—Å–∏—Ç –æ—Ç –∫–ª–∏–µ–Ω—Ç–∞ | ‚úÖ –ï–¥–∏–Ω–æ–æ–±—Ä–∞–∑–Ω–æ    |
| **–ë—Ä–µ–Ω–¥–∏–Ω–≥/–õ–æ–≥–æ—Ç–∏–ø—ã**  | ‚ùå –û–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ        | ‚úÖ –ü–æ–ª–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å |
| **–†–∞–∑–º–µ—Ä –±–∞–Ω–¥–ª–∞**      | ‚ùå +–±–∏–±–ª–∏–æ—Ç–µ–∫–∞        | ‚úÖ –ë–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π   |
| **–ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ**        | ‚ö†Ô∏è –ë—Ä–∞—É–∑–µ—Ä            | ‚úÖ –°–µ—Ä–≤–µ—Ä + CDN    |

## –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### –î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

```bash
VITE_QR_MODE=client  # –ë—ã—Å—Ç—Ä–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –±–µ–∑ —Å–µ—Ä–≤–µ—Ä–∞
```

### –î–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞

```bash
VITE_QR_MODE=server  # –ö–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å –∏ –±—Ä–µ–Ω–¥–∏–Ω–≥
```

### –î–ª—è PWA/–æ—Ñ–ª–∞–π–Ω

```bash
VITE_QR_MODE=client  # –†–∞–±–æ—Ç–∞ –±–µ–∑ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞
```

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è

- **–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞**: `qrcode` –¥–ª—è –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
- **Fallback**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –ø—Ä–∏ –æ—à–∏–±–∫–µ —Å–µ—Ä–≤–µ—Ä–∞
- **–§–æ—Ä–º–∞—Ç**: Data URLs –∏ Blob URLs
- **–†–∞–∑–º–µ—Ä**: 256x256px (–Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è)

### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –±—ç–∫–µ–Ω–¥–æ–º

```typescript
// API –∫–ª–∏–µ–Ω—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è–µ—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é
const response = await fetch('/objects/{id}/qrcode', {
  headers: { Authorization: `Bearer ${token}` },
});
const blob = await response.blob();
const url = URL.createObjectURL(blob);
```

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

```typescript
try {
  // –ü–æ–ø—ã—Ç–∫–∞ —Å–µ—Ä–≤–µ—Ä–Ω–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
  const qrUrl = await generateQRCode(objectId, { mode: 'server' });
} catch (serverError) {
  // Fallback –Ω–∞ –∫–ª–∏–µ–Ω—Ç—Å–∫—É—é –≥–µ–Ω–µ—Ä–∞—Ü–∏—é
  const objectUrl = createObjectUrl(objectId);
  const qrUrl = await generateQRCode(objectUrl, { mode: 'client' });
}
```

## –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –±—Ä–µ–Ω–¥–∏–Ω–≥–∞

```typescript
// –î–ª—è —Å–µ—Ä–≤–µ—Ä–Ω–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ - –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è –Ω–∞ –±—ç–∫–µ–Ω–¥–µ
// –î–ª—è –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–π - –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–æ—Ç–∏–ø:
const qrUrl = await generateQRCode(text, {
  width: 512,
  margin: 4,
  color: {
    dark: '#000000',
    light: '#FFFFFF',
  },
});
```

### –ü–∞–∫–µ—Ç–Ω–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è

```typescript
// –î–ª—è –º–∞—Å—Å–æ–≤–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –ª—É—á—à–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–µ—Ä–≤–µ—Ä
const qrCodes = await Promise.all(objectIds.map((id) => generateQRCode(id, { mode: 'server' })));
```

## –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –ú–µ—Ç—Ä–∏–∫–∏ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è

- –í—Ä–µ–º—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ QR-–∫–æ–¥–æ–≤
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ fallback'–æ–≤ –Ω–∞ –∫–ª–∏–µ–Ω—Ç
- –û—à–∏–±–∫–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫–µ—à–∞ (–¥–ª—è —Å–µ—Ä–≤–µ—Ä–Ω–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏)

### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

```typescript
// –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ª–æ–≥–∏—Ä—É–µ—Ç—Å—è –≤ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞
console.log('QR generation mode:', mode);
console.warn('Server QR failed, fallback to client');
console.error('QR generation failed:', error);
```
